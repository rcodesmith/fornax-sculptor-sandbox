import "classpath:/library-person-gwt.btdesign"
import "classpath:/library-gwt.btdesign"

gui LibraryWeb for Library {

	Module for main {
		
		View Menu {
			contents {
				
				link mediaBrowseLink toView MediaBrowse {
					label = "Media Browse"
				}
				
				"Link to PersonForm view"
				link personLink toView PersonForm toDestination "someDest" {
					label = "Person Form"
				}
				

			}
		}

	}
	
	Module for person {
		> @PersonService
		
		View PersonForm for Person {
			> @PersonService
			
			parameters {
				String command not nullable;
				Integer id nullable;
			}
			contents {
				inputText nameField forPath "name" {
					label = "Name"
				}
				inputText birthDateField  { // forProperty birthDate
					label = "Birth Date"
				}
				
				listBox genderSelector forProperty sex forEnum Gender {
					label = "Gender"
				}
				
				listBox personSelector for Person {
					label = "Person"
				}
				
				table table1 {
					label = "Table uno"
				}
				
				button saveButton {
					label = "Save"
				}
				
				informationalText info1 forProperty ssn.number {
					label = "Info Numero Uno"
				}
				
				informationalText fullName forOp getDisplayName {
					label = "Full name"
				}
				textArea textArea1 {
					label = "Text area uno"
				}
				
				autocomplete autocomp1 {
					label = "Auto complete one"
					onSelectItem=navigateToMediaBrowse
				}
			}
		}
		
		View TableView {
			hint="somehint"
			parameters {
				String param1;
			}
			contents {
				table personTable for Person {
					label="Person Table"
					
					enabled isTableEditable
					visible isTableEditable
					paging
//					size=20
					columns {
						name type=Text forOp getDisplayName filterable sortable;
						
						birthDate type=Date editable; // forProperty birthDate

						widget listBox genderSelector forPath "sex" forEnum Gender {
							label = "Gender"
							onSelectItem=populatePersonDetailsPanel,updatePerson
						}
						
						edit type=Button onClick=populatePersonDetailsPanel;
						
						widget link someLink {
							label = "Some Link"
							onClick = someLinkBehavior
							
						}

					}
				}
				
				panel personDetailsPanel for Person {
					hint="paneltype=SimplePanel"
					disclosure
					contents {
						inputText nameField forPath "name" {
							label = "Name"
						}
						inputText birthDateField  { // forProperty birthDate
							label = "Birth Date"
						}

					}
				}
				
				button saveButton {
					label = "Save"
					onClick = saveChanges
				}

				"this is an empty panel"
				panel personDetailsEmptyPanel {
					contents {
						
					}
				}
				
				custom customLink {
					label="Custom Link"
				}
			}
			"Populate the person details panel"
			UiBehavior PopulatePanel populatePersonDetailsPanel {
				panel=personDetailsPanel
			}
			"Populate the person details panel2"
			UiBehavior PopulatePanel populatePersonDetailsPanel2 {
				panel=personDetailsPanel
			}
			
			UiBehavior Custom someLinkBehavior {
				
			}
			
			UiBehavior UpdateAttribute updatePerson {
				
			}

			"Confirm the user wants to do something"
			UiBehavior ConfirmMessage confirmSomeMessage {
				message="Are you really sure you want to do this!?!?"
			}
		
			UiBehavior UpdateTable updatePersonTable {
				hint = "updateTableHint"
				table = personTable
			}
			
			UiBehavior Custom customPersonTableBehavior {
				hint="customhint"
			}

			UiBehavior Custom saveChanges {
			}

			"Documentation on the MarkDirty behavior"
			UiBehavior MarkDirty markViewDirty {
				hint="customhint"
				
				specificObject
			}

			"Documentation on the MarkClean behavior"
			UiBehavior MarkClean markViewClean {
				hint="customhint"
				
				specificObject
			}
			
			
			"Behavior to popup a panel"
			UiBehavior PopupPanel popupPersonDetails {
				panelName = "Person details"
				view = PersonPopup
			}

			"Warn if view is dirty"
			UiBehavior WarnIfDirty warnIfViewDirty {
				message="View is dirty."
			}
			
			Condition Custom isTableEditable {
				hint = "somehint2"
			}
			
		
			
		}
		
		
		View PersonPopup {
			parameters {
				Long personId;
			}
			contents {
				informationalText personId {
					label = "Person ID"
				}
			}
		}
		
		"This is some MyEvent1 documentation"
		Event MyEvent1 {
			String attr1;
			
			"This is some documentation"
			Integer attr2;
			
			Date date1;
			
			DateTime dateTime1;
		}

		"Navigate"
		UiBehavior NavigateToView navigateToMediaBrowse {
			view=MediaBrowse
		}

		"Composite"
		UiBehavior Composite compositeBehavior {
			navigateToMediaBrowse
		}
		
		Condition Custom isAdministrator {
			hint = "somehint1"
		}
				
	}
	
	Module for media {
		basePackage = org.fornax.cartridges.sculptor.examples.library.mediaalt
		
		
		> @MediaService
		
		skip GameMedia
		
		
		View MediaBrowse {
			> @MediaService
			
			parameters {
				String libraryId;
			}

			contents {
				table libraryTable for Library {
					label="Library Table"
					
					columns {
						name type=Text;
					}
				}
				inputText libraryId {
					label = "Library ID"
				}

				inputText name {
					label = "Name"
				}

			}
		}
		
		
	}

}